
<!DOCTYPE html>
<html lang="en">
  <head>
	<meta name="google-site-verification" content="ymvEUIQUSh8G3bf-H26Z6iSAE8Acxa-5qSWb5MSZtvY" />
	  
	<meta charset="utf-8">
	<meta name="viewport" content="initial-scale = 1.0,maximum-scale = 1.0" />
	<title>Антон Шувалов :: Домашний сервер. Первые шаги</title>
	<meta name="author" content="Антон Шувалов">
	<meta name="description" content="Цикл статей о том, как сделать домашний сервер.">
	<meta name="keywords" content="" />
	<!--[if lt IE 9]> <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script> <![endif]-->
	<link rel="shortcut icon"  href="/assets/themes/twitter/img/favicon.png">
	<link rel="image_src" href="/assets/themes/twitter/img/touch-icons/apple-touch-icon-114x114.png">
	<link rel="apple-touch-icon" href="/assets/themes/twitter/img/touch-icons/apple-touch-icon.png">
	<link rel="apple-touch-icon" sizes="72x72" href="/assets/themes/twitter/img/touch-icons/apple-touch-icon-72x72.png">
	<link rel="apple-touch-icon" sizes="114x114" href="/assets/themes/twitter/img/touch-icons/apple-touch-icon-114x114.png">
	<link href="http://feeds.feedburner.com/anton-shuvalov/JHar" rel="alternate" title="Антон Шувалов" type="application/atom+xml" />
	<link rel="stylesheet" href="/assets/themes/twitter/bootstrap/css/style.css" media="all">
	<link rel="stylesheet" href="/assets/libs/highlight/highlight.css" media="all">
  </head>
  <body>
	  
	<header class="container site-header">
		<a class="rss-link" href="http://feeds.feedburner.com/anton-shuvalov/JHar">RSS</a>
		<h2 class="site-title"><a href="/">Антон Шувалов</a></h2>
		<p class="site-tagline">Ношу шлем. Тяжело дышу.</p>
		<hr>
	</header>
	
	<div class="container">
		<section class="content">
			
<div class="page-header">
  <h1>Домашний сервер. Первые шаги</h1>
</div>

<div class="row">
  <div class="span8 post-content">
    <h2 id='_debian'>Установка Debian</h2>

<p>Установка Debian не представляет из себя ничего сложного. На <a href='http://www.debian.org/'>официальном сайте</a> я скачал дистрибутив для AMD64. Прожег диск, вставил его в привод сервера. Согласился с предложением BIOS загрузиться с CD. Когда инсталятор предложил мне выбрать пакеты для автоматической установки, я отметил только SSH-server.</p>

<p>Здесь стоит сделать небольшую ремарку относительно размещения моего сервера. Системный блок стоит в тесной маленькой кладовке, и работать с ним напрямую, с помощью клавиатуры и мышки жутко неудобно. По этому практически все время я планирую работать с ним на моем MacBook посредством SSH.</p>

<p>После перезагрузки я посмотрел IP с помощью <code>ifconfig</code>. В своем MacBook я открыл конфиг SSH.</p>
<pre><code>mate ~/.ssh/config</code></pre>
<p>И дописал в него свой новый сервер.</p>
<pre><code>Host ayanami
&#35; My home server
HostName 192.168.1.101
RemoteForward 52698 127.0.0.1:52698
User rei
Port 22</code></pre>
<p>Строчка <code>RemoteForward</code> нужна для проброса порта обратно, с сервера на MacBook. Это пригодится мне при настройке rmate. И так, подключаюсь к серверу, и вижу шелл.</p>
<pre><code>ssh ayanami</code></pre>
<p><img alt='' src='http://31808.selcdn.ru/it-prm/pics/ssh_login_rei.jpg' /></p>

<h2 id='rmate'>rmate</h2>

<p>поставил по своей же <a href='/2012/06/15/TextMate2-mate-and-rmate/'>инструкции</a> которую я писал в блог.</p>

<h2 id='ruby'>ruby</h2>

<p>Ruby поставил из aptitude, нужен для того, что бы работал rmate.</p>

<h2 id='sudo'>Sudo</h2>

<p>Sudo пригодится для того, что бы не сидеть под суперпользователем, и не перелогиниваться каждый раз, когда нужны привилегии root&#8217;а. Без проблем устанавливается через <code>apt-get</code> или <code>aptitude</code>.</p>
<pre><code>rmate /etc/sudoers</code></pre>
<p>Под строкой <code>root ALL=(ALL) ALL</code> нужно дописать</p>
<pre><code>&lt;user&gt; ALL=(ALL) ALL</code></pre>
<h2 id='webmin'>webmin</h2>

<p>Webmin — это веб-панель для мониторинга сервера. Пишут, что можно даже в консоль не залазить, если эта штука стоит. Хотя заменять консоль веб-интерфейсом — это не для меня, но вот мониторинг системы — штука нужная.</p>

<p>Для установки с помощью APT нужно отредактировать файл <code>/etc/apt/sources.list</code> и дописать туда <pre><code>deb http://download.webmin.com/download/repository sarge contrib
deb http://webmin.mirror.somersettechsolutions.co.uk/repository sarge contrib</code></pre> Потом нужно добавить ключ к репозиторию. <pre><code>cd /tmp
wget http://www.webmin.com/jcameron-key.asc
apt-key add jcameron-key.asc</code></pre> Ну и теперь можно устанавливать <pre><code>apt-get update
apt-get install webmin</code></pre> Все зависимости разрешаются автоматически. После набираю в браузере <code>http://server-ip:10000</code> и видим веб-интерфейс webmin.</p>

<p><img alt='' src='http://31808.selcdn.ru/it-prm/pics/webmin.jpg' /></p>

<h2 id='zsh'>zsh</h2>
<pre><code>sudo apt-get install zsh</code></pre>
<p>После этого под каждым пользователем, который должен использовать zsh нужно сменить шелл: <pre><code>chsh</code></pre> В появившемся диалоге нужно вписать <pre><code>/bin/zsh</code></pre></p>

<p>Я пока что поставил первый попавшийся <a href='http://blackdiv.livejournal.com/39996.html'>конфиг</a>:</p>
<pre><code>. /etc/zsh_command_not_found #подключаем стандартный вывод убунты 
autoload -U compinit # настраиваем автодополнение
compinit 
HISTFILE=~/.zhistory # устанавливаем файл истории для zsh
HISTSIZE=10000 # размер истории
SAVEHIST=10000 
setopt  APPEND_HISTORY # убираем повторы и пустые строки в истории
setopt  HIST_IGNORE_ALL_DUPS 
setopt  HIST_IGNORE_SPACE 
setopt  HIST_REDUCE_BLANKS 
setopt autocd # смену пути без команды cd
setopt CORRECT_ALL # корректировку ошибок
export PS1 NLSPATH PAGER MAIL LS_COLORS LS_OPTIONS LIBRARY_PATH \
            C_INCLUDE_PATH CPLUS_INCLUDE_PATH EDITOR TERM XFILESEARCHPATH # экспортируем всякие полезности
bindkey -e # устанавливаем клавиши как в e-macs
fc -R $HISTFILE # подгружаем старую историю
# если мы находимся под обычным пользователем то в приветствии, в конце будет - &gt;  если под рутом то - #
if [[ $EUID == 0 ]]; then
PS1=$'%{\e[1;7m%}%n@%m:%~ #%{\e[1;0m%} ';
else
PS1=$'%{\e[1;7m%}%n@%m:%~ >%{\e[1;0m%} ';
fi
PROMPT=$PS1;
#и справа в качечтве приветствия выведем время.
RPROMPT=$'%{\e[1;34m%}%T%{\e[0m%}' 
#добавляем стандартные алиасы
alias ls='ls -F --color=auto'
alias ll='ls -l'
alias la='ls -A'
alias li='ls -ial'
alias lsd='ls -ld *(-/DN)'
#указываем пути к манам
manpath="/usr/man:/usr/share/man:\
/usr/local/man:/usr/X11R6/man:/opt/qt/doc"
export MANPATH

</code></pre>
    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/2013/01/05/homeserver_intro" title="Домашний сервер. Интро">&larr; Назад</a></li>
      
      
        <li class="next"><a href="/2013/01/08/static_ip" title="Как я ипользую статический IP">Вперед &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
  </div>
  
  <div class="span4">
    <h4>Опубликовано</h4>
    <div class="date post-date"><span>06 January 2013</span></div>

  
    <h4>Теги</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags.html#debian-ref">debian <sup>3</sup></a></li>
     
    	<li><a href="/tags.html#homeserver-ref">homeserver <sup>3</sup></a></li>
    
  



    </ul>
    
  </div>
  <hr>
  <div class="span8 comments">
      


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'a3heee'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<!-- <a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a> -->




  </div>
</div>


		</section>
		<hr>
		<footer>
			<p>
				<span>&copy; Антон Шувалов 2012.</span> <br />
				<span><a href="https://github.com/mojombo/jekyll">Jekyll</a></span> |
				<span><a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a></span> | 
				<span><a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a></span>
			</p>
		</footer>
	</div>
	
	<h1>ANALITYCS</h1>



	
	
	<script type="text/javascript">

	  var _gaq = _gaq || [];
	  _gaq.push(['_setAccount', 'UA-26825614-2']);
	  var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
	  _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
	  _gaq.push(['_trackPageview']);

	  (function() {
	    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
	    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
	    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	  })();
	
		var trackingByInterval = (function trackingByInterval () {
			var timerCallback = function timerCallback () {
				_gaq.push(['_trackEvent', 'Reading', 'every 10 sec']);
			}
			setInterval(timerCallback, 5000);
		})();
		(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter19212163 = new Ya.Metrika({id:19212163, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");
	</script>
	<noscript><div><img src="//mc.yandex.ru/watch/19212163" style="position:absolute; left:-9999px;" alt="" /></div></noscript>
	
	<script type="text/javascript" src="/assets/libs/highlight/highlight.pack.js"></script>
	<script>hljs.initHighlightingOnLoad();</script>

  </body>
</html>
