---

layout: post
title: "Как к Mac OS X подключить HDD от DD-WRT"
keywords: ["dd-wrt", "mac", "os x", "роутер", "HDD", "torrents"]
---


Пару лет назад я поставил на свой DIR300 прошивку DD-WRT. Потом был 
ASUS WL500, к которому я подключил HDD, поставил transmission и открыл 
к диску доступ по `samba`. Позднее я сменил роутер на Netgear 3500L. Диск
остался прежним. Ну и за пару лет там накопилось много хлама. За упорство, 
с которым роутер раздавал купленые на humblebundle игры (sic!), ему нужно поставить
памятник при жизни. 

Вдруг, что то пошло не так, и роутер перестал загружать диск. Передо мной
возникла перспектива покупки нового диска и установки заново всех приложений.
Их было не так уж и много, но на настройку каждого у меня уходил примерно день 
или два. К счастью с диском все было ок — причиной сбоя была программная ошибка.
Но мне все равно пришлось потратить около недели на восстановление установленных
служб и программ. Справиться с грамотной настройкой ProFTP у меня почему-то так
и не вышло, да и samba постоянно отпадывала. К этому времени пользование
Transmission-Daemon свелось к банальному дублированию загрузок: на ноутбук и,
через веб-интерфейс, на роутер для раздачи 24/7. А позднее я совсем перестал
пользоваться роутером как торрент-клиентом из-за этих неудобств.

Не так давно [я сделал из старого ненужного PC сервер и спрятал его в чулан][homeserver].
Я поставил на него [transmission][], [настроил vpn][vpn] до своей домашней сети,
удалил uTorrent с MacBook и поставил вместо него Transmission Remote GUI. 
До файлов всегда можно дотянуться через стабильную самбу, да и в перспективе я
планирую доставить пару 2TB дисков для файлового архива. Вся эта система работает
достаточно удобно, и я решил что пора бы перекинуть торренты с роутера на сервер.
Но вдруг оказалось, что эта процедура не такая уж и простая — Mac OS просто
не понимала что за файловая система к ней подключена. Изначально я пришел к
неправильному выводу и решил, что DD-WRT использует файловую систему JFFS2
на всех дисках кроме свопа. Гугл не предолжил никакого адекватного решения.
Качать 100GB через падающую каждые 10 минут samba мне ни как не хотелось.

Сегодня я решил попытаться поднять на роутере ProFTP и скинуть через него файлы,
вроде как процесс не сильно отличается от настройки VPN, а там все было очень
легко. ProFTP я настроил, подключился к HDD, но не увидел там ни одного файла.
Я начал подумывать о том, что бы отложить переезд на еще один неопределенный срок.
Прокручивая эти мысли я зашел в настройки USB на роутере, что бы проверить, тот
ли каталог я показываю по FTP. Каталог был тот. Но я заметил, что файловая
система там была не JFFS2, а Ext3. Смонтировать Ext3 диск на Mac OS вполне
себе реально.


## Mac OS X Mountain Lion и Ext3

Нужно скачать и установить два приложения:

[OSXFuse][]{: rel="nofollow" target="_blank"}&nbsp;— [Скачать][OSXFuse_dl]  
[Fuse-ext2][]{: rel="nofollow" target="_blank"}&nbsp;— [Скачать][Fuse-ext2_dl]

Fuse-ext2 использует MacFuse для работы. Но MacFuse не работает ни в 
Mac&nbsp;OS&nbsp;X&nbsp;Lion, ни в Mountain&nbsp;Lion. OSXFuse — это более
современная версия MacFuse, которая лишена этих проблем, но это не значит,
что Fuse-ext2 будет с работать с OSXFuse. К счастью, OSXFuse содержит
`MacFUSE Compatibility Layer`. Для того, что бы все заработало, OSXFuse
нужно установить с этим параметром.

Готово. Все установлено. Теперь достаточно вытащить диск из роутера и включить
его в MacBook. Диск смонтируется автоматически. Возможно, понадобится
перезагрузка. Мне не понадобилась. Мой диск смонтировался только на чтение,
вероятно это связано с правами доступа, вероятно это особенность драйверов.
Я решил не выяснять подробности, потому что этого мне было достаточно.


[homeserver]:      /2013/01/05/homeserver_intro/
[transmission]:    /2013/01/28/debian-squeeze-transmission/
[vpn]:             /2013/01/16/ddwrt-vpn/
[OSXFuse]:         http://osxfuse.github.com/
[OSXFuse_dl]:      https://github.com/osxfuse/osxfuse/downloads
[Fuse-ext2]:       http://alperakcan.org/?open=projects&amp;project=fuse-ext2
[Fuse-ext2_dl]:    http://prdownloads.sourceforge.net/fuse-ext2/fuse-ext2-0.0.7.dmg?download